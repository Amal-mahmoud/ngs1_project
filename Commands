# Assignment number 1
## Download SRA data
wget -c ftp://ftp-trace.ncbi.nih.gov/sra/sra-instant/reads/ByRun/sra/SRR/SRR879/SRR8797509/SRR8797509.sra

## Download SRAtoolkit
wget -c https://ftp-trace.ncbi.nlm.nih.gov/sra/sdk/2.9.6/sratoolkit.2.9.6-ubuntu64.tar.gz

## unzip sratoolkit
tar xvzf sratoolkit.2.9.6-ubuntu64.tar.gz

## Add SRAtoolkit to the PATH
PATH=$PATH: /home/ngs-01/Downloads/sratoolkit.2.9.6-ubuntu64/bin

## Convert *.SRA file to 2 separate FASTQ files (forward & reverse reads) using fastq-dump and downloading the first 5000000 reads only:
fastq-dump --split-files -X 5000000 SRR8797509.sra

## counting number of sequences in the fastq file
grep '@' SRR8797509.fastq | wc -l

## Use the seqkit tool to split the main fastq file into separate files
seqkit split2  SRR8797509_1.fastq -s 1000000
seqkit split2  SRR8797509_2.fastq -s 1000000

## shuffleing the main fastq files (Forward and reverse reads) each containing the 5000000 reads
seqkit shuffle SRR8797509_1.fastq > SRR8797509_1_shuffled.fastq
seqkit shuffle SRR8797509_2.fastq > SRR8797509_2_shuffled.fastq

##split the shuffled files
seqkit split2  SRR8797509_1_shuffled.fastq -s 1000000
seqkit split2  SRR8797509_2_shuffled.fastq -s 1000000

## Quality Control checking
## checking the first sample before and after shuffling for quality control using FASTQC
## install the required tools for performing the quality control assessment

conda install -c bioconda fastqc
conda install -c bioconda multiqc

##FastQC assessment for the first sample before shuffling
mkdir ~/workdir/Assignment/FASTQC_results && cd ~/workdir/Assignment/FASTQC_results
for f in ~/workdir/Assignment/SRR8797509.fastq.split/SRR8797509_*.part_001.fastq;do
fastqc -t 1 -f fastq -noextract -o . $f;done

## merging the fastQC reports of the two reads of sample 1 before shuffling
multiqc -z -o . .

##FastQC assessment for the first sample after shuffling
mkdir ~/workdir/Assignment/FASTQC_results_shuffled && cd ~/workdir/Assignment/FASTQC_results_shuffled
for f in ~/workdir/Assignment/shuff_SRR8797509.fastq.split/shuff_SRR8797509_*.part_001.part_001.fastq;do 
fastqc -t 1 -f fastq -noextract -o . $f;done

##merging the fastQC reports of the two reads of sample 1 after shuffling
##multiqc -z -o . .



